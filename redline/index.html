<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="google_style.css" />
        <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=true">
        </script>
        <script type="text/javascript">
            var myLat = 42.3581;
            var myLng = -71.0636;
            //request = new XMLHttpRequest();
            //Maybe just find the lat, lang of Boston instead of getting mine
            var me = new google.maps.LatLng(myLat, myLng);
            var myOptions = {
                        zoom: 13, // The larger the zoom number, the bigger the zoom
                        center: me,
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                    };
            function initialize() {
                map = new google.maps.Map(document.getElementById("map-canvas"), myOptions);
                getMyLocation();
            }

            function createCORSRequest(method, url){
                var xhr = new XMLHttpRequest();
                if ("withCredentials" in xhr){
                    xhr.open(method, url, true);
                } else if (typeof XDomainRequest != "undefined"){
                    xhr = new XDomainRequest();
                    xhr.open(method, url);
                } else {
                    xhr = null;
                }
                return xhr;
            }

            function getMyLocation() {
              /*  if (navigator.geolocation) { // the navigator.geolocation object is supported on your browser
                    navigator.geolocation.getCurrentPosition(function(position) {
                        myLat = position.coords.latitude;
                        myLng = position.coords.longitude; */
                        getTrains();
                   /* });
                }
                else {
                    alert("Geolocation is not supported by your web browser.  What a shame!");
                }*/
            }
            function getTrains() {
                console.log("in getTrains");
                me = new google.maps.LatLng(myLat, myLng);
                request = createCORSRequest("get", "http://developer.mbta.com/lib/rthr/red.json");
                request.onreadystatechange = function () 
                {
                    if (request.readystate == 4 && request.status == 200)
                    {
                        console.log("in this thing");
                        trains = JSON.parse(request.responseText);
                        console.log(trains);
                    }
                }
                request.send();
            }
            google.maps.event.addDomListener(window, 'load', initialize);

        </script>
    </head>
    <body>
    <div id="map-canvas"></div>
    </body>
</html>